{% extends 'layout/base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
    <div class="d-flex flex-column-fluid mt-20">
        <!--begin::Container-->
        <div class=" container-fluid ">
            <!--begin::Card-->
            <div class="card card-custom gutter-b">
                <div class="card-body">
                    <div class="d-flex">
                        <!--begin: Pic-->
                        <div class="flex-shrink-0 mr-7 mt-lg-0 mt-3">
                            <div class="symbol symbol-50 symbol-lg-120">
                                <img alt="Pic" src="{% static 'assets/media/bg/bgprojetjaune.png' %}"/>
                            </div>
                        </div>
                        <!--end: Pic-->

                        <!--begin: Info-->
                        <div class="flex-grow-1">
                            <!--begin: Title-->
                            <div class="d-flex align-items-center justify-content-between flex-wrap">
                                <div class="mr-3">
                                    <!--begin::Name-->
                                    <a href="#"
                                       class="d-flex align-items-center text-dark text-hover-primary font-size-h5 font-weight-bold mr-3">
                                        {{ projects_details.name }} <i
                                            class="flaticon2-correct text-success icon-md ml-2"></i>
                                    </a>
                                    <!--end::Name-->

                                    <!--begin::Contacts-->
                                    <div class="d-flex flex-wrap my-2">
                                        <a href="#"
                                           class="text-muted text-hover-primary font-weight-bold mr-lg-8 mr-5 mb-lg-0 mb-2">
                                <span class="svg-icon svg-icon-md svg-icon-gray-500 mr-1"><!--begin::Svg Icon | path:assets/media/svg/icons/Communication/Mail-notification.svg--><svg
                                        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                        width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <rect x="0" y="0" width="24" height="24"/>
        <path d="M21,12.0829584 C20.6747915,12.0283988 20.3407122,12 20,12 C16.6862915,12 14,14.6862915 14,18 C14,18.3407122 14.0283988,18.6747915 14.0829584,19 L5,19 C3.8954305,19 3,18.1045695 3,17 L3,8 C3,6.8954305 3.8954305,6 5,6 L19,6 C20.1045695,6 21,6.8954305 21,8 L21,12.0829584 Z M18.1444251,7.83964668 L12,11.1481833 L5.85557487,7.83964668 C5.4908718,7.6432681 5.03602525,7.77972206 4.83964668,8.14442513 C4.6432681,8.5091282 4.77972206,8.96397475 5.14442513,9.16035332 L11.6444251,12.6603533 C11.8664074,12.7798822 12.1335926,12.7798822 12.3555749,12.6603533 L18.8555749,9.16035332 C19.2202779,8.96397475 19.3567319,8.5091282 19.1603533,8.14442513 C18.9639747,7.77972206 18.5091282,7.6432681 18.1444251,7.83964668 Z"
              fill="#000000"/>
        <circle fill="#000000" opacity="0.3" cx="19.5" cy="17.5" r="2.5"/>
    </g>
</svg><!--end::Svg Icon--></span> {{ projects_details.manager }}
                                        </a>
                                        <a href="#"
                                           class="text-muted text-hover-primary font-weight-bold mr-lg-8 mr-5 mb-lg-0 mb-2">
                                <span class="svg-icon svg-icon-md svg-icon-gray-500 mr-1"><!--begin::Svg Icon | path:assets/media/svg/icons/General/Lock.svg--><svg
                                        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                        width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><mask
                                            fill="white"><use xlink:href="#path-1"/></mask><g/>
                                        <path d="M7,10 L7,8 C7,5.23857625 9.23857625,3 12,3 C14.7614237,3 17,5.23857625 17,8 L17,10 L18,10 C19.1045695,10 20,10.8954305 20,12 L20,18 C20,19.1045695 19.1045695,20 18,20 L6,20 C4.8954305,20 4,19.1045695 4,18 L4,12 C4,10.8954305 4.8954305,10 6,10 L7,10 Z M12,5 C10.3431458,5 9,6.34314575 9,8 L9,10 L15,10 L15,8 C15,6.34314575 13.6568542,5 12,5 Z"
                                              fill="#000000"/></g>
</svg><!--end::Svg Icon--></span> {{ projects_details.manager.groups }}
                                        </a>

                                    </div>
                                    <!--end::Contacts-->
                                </div>
                                <div class="my-lg-0 my-1">
                                    <a href="#"
                                       class="btn btn-sm btn-light-success font-weight-bolder text-uppercase mr-3">Reports</a>
                                    <a href="#" class="btn btn-sm btn-info font-weight-bolder text-uppercase"
                                       data-toggle="modal" data-target="#taskModal">Nouvelle Tache</a>
                                    <a href="#" class="btn btn-sm btn-warning font-weight-bolder text-uppercase"
                                       data-toggle="modal" data-target="#depensesModal">Declarer une depense</a>
                                    <div class="modal fade" id="depensesModal" data-backdrop="static" tabindex="-1"
                                         role="dialog" aria-labelledby="staticBackdrop" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Declaration de
                                                        dépense</h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                        <i aria-hidden="true" class="ki ki-close"></i>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form method="post" enctype="multipart/form-data">
                                                        {% csrf_token %}
                                                        <!-- Afficher les erreurs générales non associées à un champ spécifique -->
                                                        {% if depense_form.non_field_errors %}
                                                            <div class="alert alert-danger">
                                                                <ul>
                                                                    {% for error in form.non_field_errors %}
                                                                        <li>{{ error }}</li>
                                                                    {% endfor %}
                                                                </ul>
                                                            </div>
                                                        {% endif %}

                                                        <!-- Afficher les champs avec leurs erreurs -->
                                                        {% for field in depense_form %}
                                                            <div class="form-group">
                                                                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                                                                {{ field }}
                                                                {% if field.errors %}
                                                                    <div class="text-danger">
                                                                        <ul>
                                                                            {% for error in field.errors %}
                                                                                <li>{{ error }}</li>
                                                                            {% endfor %}
                                                                        </ul>
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                        {% endfor %}

                                                        <button type="submit" class="btn btn-primary btn-block"
                                                                name="add_depense">Ajouter
                                                        </button>
                                                    </form>
                                                </div>

                                            </div>
                                        </div>
                                    </div>

                                    <div class="modal fade" id="taskModal" data-backdrop="static" tabindex="-1"
                                         role="dialog" aria-labelledby="staticBackdrop" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Ajouter une nouvele
                                                        tâche</h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                        <i aria-hidden="true" class="ki ki-close"></i>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form method="post" enctype="multipart/form-data">
                                                        {% csrf_token %}
                                                        <!-- Afficher les erreurs générales non associées à un champ spécifique -->
                                                        {% if task_form.non_field_errors %}
                                                            <div class="alert alert-danger">
                                                                <ul>
                                                                    {% for error in form.non_field_errors %}
                                                                        <li>{{ error }}</li>
                                                                    {% endfor %}
                                                                </ul>
                                                            </div>
                                                        {% endif %}

                                                        <!-- Afficher les champs avec leurs erreurs -->
                                                        {% for field in task_form %}
                                                            <div class="form-group">
                                                                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                                                                {{ field }}
                                                                {% if field.errors %}
                                                                    <div class="text-danger">
                                                                        <ul>
                                                                            {% for error in field.errors %}
                                                                                <li>{{ error }}</li>
                                                                            {% endfor %}
                                                                        </ul>
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                        {% endfor %}

                                                        <button type="submit" class="btn btn-primary btn-block"
                                                                name="add_task">Créer
                                                        </button>
                                                    </form>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--end: Title-->

                            <!--begin: Content-->
                            <div class="d-flex align-items-center flex-wrap justify-content-between">
                                <div class="flex-grow-1 font-weight-bold text-dark-50 py-5 py-lg-2 mr-5">
                                    {{ projects_details.description|truncatewords:60 }}
                                </div>

                                <div class="d-flex flex-wrap align-items-center py-2">
                                    <div class="d-flex align-items-center mr-10">
                                        <div class="mr-6">
                                            <div class="font-weight-bold mb-2"> Date de début</div>
                                            <span class="btn btn-sm btn-text btn-light-primary text-uppercase font-weight-bold">{{ projects_details.start_date|naturalday }}</span>
                                        </div>
                                        <div class="">
                                            <div class="font-weight-bold mb-2"> Date de fin</div>
                                            <span class="btn btn-sm btn-text btn-light-danger text-uppercase font-weight-bold">{{ projects_details.end_date|naturalday }}</span>
                                        </div>
                                    </div>

                                    <div class="flex-grow-1 flex-shrink-0 w-150px w-xl-300px mt-4 mt-sm-0">
                                        <span class="font-weight-bold">Progress</span>
                                        <div class="progress progress-xs mt-2 mb-2">
                                            <div class="progress-bar bg-success" role="progressbar"
                                                 style="width: {{ projects_details.progress_percentage }}%;"
                                                 aria-valuenow="{{ projects_details.progress_percentage }}"
                                                 aria-valuemin="0" aria-valuemax="100">
                                            </div>
                                        </div>
                                        <span class="font-weight-bolder text-dark">{{ projects_details.progress_percentage }}%</span>
                                    </div>

                                </div>
                            </div>
                            <!--end: Content-->
                        </div>
                        <!--end: Info-->
                    </div>

                    <div class="separator separator-solid my-7"></div>

                    <!--begin: Items-->
                    <div class="d-flex align-items-center flex-wrap">
                        <!--begin: Item-->
                        <div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
                <span class="mr-4">
                    <i class="flaticon-piggy-bank icon-2x text-muted font-weight-bold"></i>
                </span>
                            <div class="d-flex flex-column text-dark-75">
                                <span class="font-weight-bolder font-size-sm">Budget estimatif</span>
                                <span class="font-weight-bolder font-size-h5"><span
                                        class="text-dark-50 font-weight-bold">CFA </span>{{ projects_details.budget_estimatif|intcomma }}</span>
                            </div>
                        </div>
                        <!--end: Item-->

                        <!--begin: Item-->
                        <div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
                <span class="mr-4">
                    <i class="flaticon-piggy-bank icon-2x text-muted font-weight-bold"></i>
                </span>
                            <div class="d-flex flex-column text-dark-75">
                                <span class="font-weight-bolder font-size-sm">Marge estimatif</span>
                                <span class="font-weight-bolder font-size-h5"><span
                                        class="text-dark-50 font-weight-bold">CFA </span>{{ projects_details.marge_estimatif|intcomma }}</span>
                            </div>
                        </div>
                        <!--end: Item-->

                        <!--begin: Item-->
                        <div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
                <span class="mr-4">
                    <i class="flaticon-confetti icon-2x text-muted font-weight-bold"></i>
                </span>
                            <div class="d-flex flex-column text-dark-75">
                                <span class="font-weight-bolder font-size-sm">Budget prévisionnel</span>
                                <span class="font-weight-bolder font-size-h5"><span
                                        class="text-dark-50 font-weight-bold">CFA </span>{{ projects_details.previsionnel|intcomma }}</span>
                            </div>
                        </div>
                        <!--end: Item-->
                        <!--begin: Item-->
                        <div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
                <span class="mr-4">
                    <i class="flaticon-piggy-bank icon-2x text-muted font-weight-bold"></i>
                </span>
                            <div class="d-flex flex-column text-dark-75">
                                <span class="font-weight-bolder font-size-sm">Marge prévisionnelle</span>
                                <span class="font-weight-bolder font-size-h5"><span
                                        class="text-dark-50 font-weight-bold">CFA</span> {{ projects_details.marge_previsionnel|intcomma|default:0 }}</span>
                            </div>
                        </div>
                        <!--end: Item-->
                        <!--begin: Item-->
                        <div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
                <span class="mr-4">
                    <i class="flaticon-pie-chart icon-2x text-muted font-weight-bold"></i>
                </span>

                            <div class="d-flex flex-column text-dark-75">
                                <span class="font-weight-bolder font-size-sm">Dépenses</span>


                                <span class="font-weight-bolder font-size-h5"><span
                                        class="text-dark-50 font-weight-bold">CFA </span>{{ projects_details.get_total_expenses|intcomma }}</span>
                            </div>
                        </div>
                        <!--end: Item-->

                        <!--begin: Item-->
                        <div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
                <span class="mr-4">
                    <i class="flaticon-piggy-bank icon-2x text-muted font-weight-bold"></i>
                </span>
                            <div class="d-flex flex-column text-dark-75">
    <span class="font-weight-bolder font-size-sm">
        <span class="text-dark-50 font-weight-bold">Profit </span>
        {{ projects_details.profit_percentage|floatformat:2 }} %
        {% if projects_details.profit_percentage > 0 %}
            <i class="fas fa-arrow-up text-success"></i>
        {% endif %}
    </span>
                                <span class="font-weight-bolder font-size-h5">
        <span class="text-dark-50 font-weight-bold">Lost </span>
        {{ projects_details.loss_percentage|floatformat:2 }} %
                                    {% if projects_details.loss_percentage > 0 %}
                                        <i class="fas fa-arrow-down text-danger"></i>
                                    {% endif %}
    </span>
                            </div>
                        </div>
                        <!--end: Item-->


                    </div>
                    <!--begin: Items-->
                </div>
            </div>
            <!--end::Card-->

            <!--begin::Row-->
            <div class="row">
                <div class="col-lg-8">
                    <!--begin::Advance Table Widget 3-->
                    <div class="card card-custom card-stretch gutter-b">
                        <!--begin::Header-->
                        <div class="card-header border-0 py-5">
                            <h3 class="card-title align-items-start flex-column">
                                <span class="card-label font-weight-bolder text-dark">Membres du Projet</span>
                                <span class="text-muted mt-3 font-weight-bold font-size-sm">More than 400+ new members</span>

                            </h3>
                            <div class="card-toolbar">
                                <a href="#" data-toggle="modal" data-target="#addmembers"
                                   class="btn btn-success font-weight-bolder font-size-sm"><span
                                        class="svg-icon svg-icon-md svg-icon-white"><!--begin::Svg Icon | path:assets/media/svg/icons/Communication/Add-user.svg--><svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px"
                                        viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon points="0 0 24 0 24 24 0 24"/>
        <path d="M18,8 L16,8 C15.4477153,8 15,7.55228475 15,7 C15,6.44771525 15.4477153,6 16,6 L18,6 L18,4 C18,3.44771525 18.4477153,3 19,3 C19.5522847,3 20,3.44771525 20,4 L20,6 L22,6 C22.5522847,6 23,6.44771525 23,7 C23,7.55228475 22.5522847,8 22,8 L20,8 L20,10 C20,10.5522847 19.5522847,11 19,11 C18.4477153,11 18,10.5522847 18,10 L18,8 Z M9,11 C6.790861,11 5,9.209139 5,7 C5,4.790861 6.790861,3 9,3 C11.209139,3 13,4.790861 13,7 C13,9.209139 11.209139,11 9,11 Z"
              fill="#000000" fill-rule="nonzero" opacity="0.3"/>
        <path d="M0.00065168429,20.1992055 C0.388258525,15.4265159 4.26191235,13 8.98334134,13 C13.7712164,13 17.7048837,15.2931929 17.9979143,20.2 C18.0095879,20.3954741 17.9979143,21 17.2466999,21 C13.541124,21 8.03472472,21 0.727502227,21 C0.476712155,21 -0.0204617505,20.45918 0.00065168429,20.1992055 Z"
              fill="#000000" fill-rule="nonzero"/>
    </g>
</svg><!--end::Svg Icon--></span>Ajout de nouveaux membres</a>
                                <div class="modal fade" id="addmembers" data-backdrop="static" tabindex="-1"
                                     role="dialog" aria-labelledby="staticBackdrop" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">Declaration de
                                                    dépense</h5>
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close">
                                                    <i aria-hidden="true" class="ki ki-close"></i>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                <form method="post" enctype="multipart/form-data">
                                                    {% csrf_token %}
                                                    <!-- Afficher les erreurs générales non associées à un champ spécifique -->
                                                    {% if add_member_form.non_field_errors %}
                                                        <div class="alert alert-danger">
                                                            <ul>
                                                                {% for error in form.non_field_errors %}
                                                                    <li>{{ error }}</li>
                                                                {% endfor %}
                                                            </ul>
                                                        </div>
                                                    {% endif %}

                                                    <!-- Afficher les champs avec leurs erreurs -->
                                                    {% for field in add_member_form %}
                                                        <div class="form-group">
                                                            <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                                                            {{ field }}
                                                            {% if field.errors %}
                                                                <div class="text-danger">
                                                                    <ul>
                                                                        {% for error in field.errors %}
                                                                            <li>{{ error }}</li>
                                                                        {% endfor %}
                                                                    </ul>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    {% endfor %}

                                                    <button type="submit" class="btn btn-primary btn-block"
                                                            name="add_member">Ajouter
                                                    </button>
                                                </form>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--end::Header-->

                        <!--begin::Body-->
                        <div class="card-body pt-0 pb-3">
                            <!--begin::Table-->
                            <div class="table-responsive">
                                <table class="table table-head-custom table-head-bg table-borderless table-vertical-center">
                                    <thead>
                                    <tr class="text-uppercase">
                                        <th style="min-width: 250px" class="pl-7"><span class="text-dark-75">Nom & penoms</span>
                                        </th>
                                        <th style="min-width: 100px">Coût Interne</th>
                                        <th style="min-width: 100px">Coût Externe</th>
                                        <th style="min-width: 100px">Temps de travail</th>
                                        <th style="min-width: 120px"></th>
                                    </tr>
                                    </thead>
                                    <tbody>


                                    {% for member in members_hours %}
                                        <tr>
                                            <td class="pl-0 py-8">
                                                <div class="d-flex align-items-center">
                                                    <div class="symbol symbol-50 flex-shrink-0 mr-4">
                                                        <div class="symbol-label"
                                                             style="background-image: url('{% static 'assets/media/users/default.jpg' %}')"></div>
                                                    </div>
                                                    <div>
                                                        <a href="#"
                                                           class="text-dark-75 font-weight-bolder text-hover-primary mb-1 font-size-lg">
                                                            {{ member.user.first_name }} {{ member.user.last_name }}
                                                        </a>
                                                        <span class="text-muted font-weight-bold d-block">{{ member.job_title }}</span>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
        <span class="text-dark-75 font-weight-bolder d-block font-size-lg">
            {{ member.daily_cost.daily_cost|intcomma }} FCFA|J
        </span>
                                                <span class="text-muted font-weight-bold">
            {{ member.daily_cost.hourly_cost|intcomma }} FCFA|H
        </span>
                                            </td>
                                            <td>
        <span class="text-dark-75 font-weight-bolder d-block font-size-lg">
            {{ member.selling_price.selling_price_daily|intcomma }} FCFA|J
        </span>
                                                <span class="text-muted font-weight-bold">
            {{ member.selling_price.selling_price_hourly|intcomma }} FCFA|H
        </span>
                                            </td>
                                            <td>
        <span class="text-dark-75 font-weight-bolder d-block font-size-lg">
            {{ member.total_hours|default:0 }} Heure(s)
        </span>
                                            </td>
                                            <td class="text-right pr-0">
                                                <a href="#"
                                                   class="btn btn-icon btn-light btn-hover-primary btn-sm mr-3">
            <span class="svg-icon svg-icon-md svg-icon-primary">
                <!-- SVG Icon -->
            </span>
                                                </a>
                                                <a href="#" class="btn btn-icon btn-light btn-hover-primary btn-sm">
            <span class="svg-icon svg-icon-md svg-icon-primary">
                <!-- SVG Icon -->
            </span>
                                                </a>
                                            </td>
                                        </tr>
                                    {% endfor %}


                                    </tbody>
                                </table>
                            </div>
                            <!--end::Table-->
                        </div>
                        <!--end::Body-->
                    </div>
                    <!--end::Advance Table Widget 3-->
                </div>
                <div class="col-lg-4">
                    <!--begin::Charts Widget 3-->
                    <div class="card card-custom card-stretch gutter-b">
                        <!--begin::Header-->
                        <div class="card-header h-auto border-0">
                            <div class="card-title py-5">
                                <h3 class="card-label">
                                    <span class="d-block text-dark font-weight-bolder">Evaluation budgetaire du projet</span>
                                </h3>
                            </div>

                        </div>
                        <!--end::Header-->

                        <!--begin::Body-->
                        <div class="card-body">
                            <div id="eval_budget"></div>
                        </div>
                        <!--end::Body-->
                    </div>
                    <!--end::Charts Widget 3-->
                </div>
            </div>
            <!--end::Row-->

            <!--begin::Row-->
            <div class="row">
                <div class="col-lg-4">


                    <!--begin::List Widget 14-->
                    <div class="card card-custom card-stretch gutter-b">
                        <!--begin::Header-->
                        <div class="card-header border-0">
                            <h3 class="card-title font-weight-bolder text-dark">Liste des 05 dernieres taches</h3>
                            <div class="card-toolbar">
                                <div class="dropdown dropdown-inline">
                                    <a href="#" class="btn btn-clean btn-hover-light-primary btn-sm btn-icon"
                                       data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="ki ki-bold-more-ver"></i>
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-md dropdown-menu-right">
                                        <!--begin::Navigation-->
                                        <ul class="navi navi-hover">

                                            <li class="navi-separator mb-3 opacity-70"></li>
                                            <li class="navi-item">
                                                <a href="#" class="navi-link">
            <span class="navi-text">
                <span class="label label-xl label-inline label-light-dark">Voir les tâches du projet</span>
            </span>
                                                </a>
                                            </li>
                                            <li class="navi-item">
                                                <a href="#" class="navi-link">
            <span class="navi-text">
                <span class="label label-xl label-inline label-light-dark">Voir toutes les tâches</span>
            </span>
                                                </a>
                                            </li>

                                        </ul>
                                        <!--end::Navigation-->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--end::Header-->

                        <!--begin::Body-->
                        <div class="card-body pt-2">
                            {% for task in latest_tasks %}
                                <!--begin::Item-->
                                <div class="d-flex flex-wrap align-items-center mb-10">

                                    <!--begin::Title-->
                                    <div class="d-flex flex-column flex-grow-1 my-lg-0 my-2 pr-3">
                                        <a href="#"
                                           class="text-dark-75 font-weight-bolder text-hover-primary font-size-lg">
                                            {{ task.name|upper }}
                                        </a>
                                        <span class="text-muted font-weight-bold font-size-sm my-1">{{ task.description|truncatechars:60 }}</span>
                                        <span class="text-muted font-weight-bold font-size-sm">Assigner à: <span
                                                class="text-primary font-weight-bold">{{ task.assigned_to }}</span></span>
                                        <span class="text-muted font-weight-bold font-size-sm">Assigner par: <span
                                                class="text-primary font-weight-bold">{{ task.assigned_by.user.first_name }} {{ task.assigned_by.user.last_name }}</span></span>
                                    </div>
                                    <!--end::Title-->

                                    <!--begin::Info-->
                                    <div class="d-flex align-items-center py-lg-0 py-2">
                                        <div class="d-flex flex-column text-right">
                    <span class="badge badge-light text-dark-75 font-weight-bolder font-size-h4">
                        {{ task.get_priority_display|upper }}
                    </span>
                                            <span class="text-muted font-size-sm font-weight-bolder">
                         {{ task.get_status_display|upper }}
                    </span>
                                        </div>
                                    </div>
                                    <!--end::Info-->
                                </div>
                                <!--end::Item-->
                            {% endfor %}
                        </div>
                        <!--end::Body-->
                    </div>
                    <!--end::List Widget 14-->
                </div>
                <div class="col-lg-4">
                    <!--begin::Charts Widget 1-->
                    <div class="card card-custom card-stretch gutter-b">
                        <!--begin::Header-->
                        <div class="card-header h-auto border-0">
                            <!--begin::Title-->
                            <div class="card-title py-5">
                                <h3 class="card-label">
                                    <span class="d-block text-dark font-weight-bolder">Evaluation des tâches</span>
                                    <span class="d-block text-muted mt-2 font-size-sm">Evaluation des tâches du projet</span>
                                </h3>
                            </div>
                            <!--end::Title-->
                        </div>
                        <!--end::Header-->

                        <!--begin::Body-->
                        <div class="card-body">
                            <!--begin::Chart-->
                            <div id="taskStatusChart"></div>
                            <!--end::Chart-->
                        </div>
                        <!--end::Body-->
                    </div>
                    <!--end::Charts Widget 1-->
                </div>
                <div class="col-lg-4">
                    <!--begin::List Widget 8-->
                    <div class="card card-custom card-stretch gutter-b">
                        <!--begin::Header-->
                        <div class="card-header border-0">
                            <h3 class="card-title font-weight-bolder text-dark">5 derniers depenses déclarées </h3>
                        </div>
                        <!--end::Header-->

                        <!--begin::Body-->
                        <div class="card-body pt-0">
                            <!--begin::Item-->
                            <div class="mb-10">
                                <!--begin::Section-->
                                {% for depense in latest_depenses %}
                                    <div class="d-flex align-items-center">

                                        <!--begin::Text-->
                                        <div class="d-flex flex-column flex-grow-1">
                                            <a href="#"
                                               class="font-weight-bold text-dark-75 text-hover-primary font-size-lg mb-1">Cathégorie
                                                de la dépense</a>
                                            <span class="text-muted font-weight-bold">{{ depense.categorie }}</span>
                                        </div>
                                        <div class="d-flex flex-column flex-grow-1 mt-5">
                                            <a href="#"
                                               class="font-weight-bold text-dark-75 text-hover-primary font-size-lg mb-1">Montant</a>
                                            <span class="text-muted font-weight-bold">{{ depense.montant|intcomma }} F CFA</span>
                                        </div>

                                        <!--end::Text-->
                                    </div>
                                {% endfor %}
                                <!--end::Section-->

                            </div>
                            <!--end::Item-->
                        </div>
                        <!--end::Body-->
                    </div>
                    <!--end: Card-->
                    <!--end::List Widget 8-->
                </div>
            </div>
            <!--end::Row-->
        </div>
        <!--end::Container-->
    </div>


{% endblock %}